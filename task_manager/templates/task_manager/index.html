{% extends "calendario/base.html" %}

{% block title %}Gestor de tareas{% endblock %}

{% block content %}
  <div class="space-y-10">
    <section class="rounded-2xl border border-slate-200 bg-white p-8 shadow-sm">
      <div class="flex flex-col gap-6 lg:flex-row lg:items-start lg:justify-between">
        <div class="max-w-3xl space-y-3">
          <span class="inline-flex items-center gap-2 rounded-full bg-brand/10 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-brand">
            Módulo de operaciones
          </span>
          <h1 class="text-3xl font-semibold text-slate-900 sm:text-4xl">Gestor integral de tareas</h1>
          <p class="text-base text-slate-600">
            Administra la definición, asignación y seguimiento de tareas operativas. Estandariza procesos, visualiza pendientes por granja y galpón, impulsa el cumplimiento diario y ofrece a los
            operarios una bandeja clara de responsabilidades.
          </p>
          <div class="flex flex-wrap gap-3 pt-2">
            <a href="#tm-definiciones" class="inline-flex items-center gap-2 rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white shadow hover:bg-brand-dark">
              Crear definición de tarea
              <span aria-hidden="true">→</span>
            </a>
            <a href="#tm-asignaciones" class="inline-flex items-center gap-2 rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-700 hover:border-brand hover:text-brand">
              Planear asignaciones
            </a>
            <a href="#tm-operario" class="inline-flex items-center gap-2 rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-700 hover:border-brand hover:text-brand">
              Vista operario
            </a>
          </div>
        </div>
        <aside class="flex grow flex-col gap-4 rounded-xl border border-slate-100 bg-slate-50/60 p-6 text-sm text-slate-700">
          <div class="flex items-center justify-between">
            <span class="font-semibold text-slate-500">Definiciones activas</span>
            <span class="text-xl font-bold text-slate-900" data-tm-placeholder="definitions-count">38</span>
          </div>
          <div class="flex items-center justify-between">
            <span class="font-semibold text-slate-500">Tareas hoy</span>
            <span class="text-xl font-bold text-slate-900" data-tm-placeholder="today-tasks">124</span>
          </div>
          <div class="flex items-center justify-between">
            <span class="font-semibold text-slate-500">Cumplimiento semanal</span>
            <span class="text-xl font-bold text-emerald-600" data-tm-placeholder="weekly-compliance">92%</span>
          </div>
          <div class="flex items-center justify-between">
            <span class="font-semibold text-slate-500">Alertas de riesgo</span>
            <span class="text-xl font-bold text-rose-600" data-tm-placeholder="risk-alerts">6</span>
          </div>
          <div class="rounded-lg border border-dashed border-brand/40 bg-brand/5 p-4 text-sm text-slate-600">
            Visualiza las métricas clave del día y profundiza desde el tablero de seguimiento.
          </div>
        </aside>
      </div>
    </section>

    <section data-tm-tabs class="space-y-6 rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
      <nav class="flex flex-wrap items-center gap-2 text-sm font-medium text-slate-500">
        <button data-tm-tab="panel" class="tab-button rounded-full bg-slate-900 px-4 py-2 text-white shadow-sm transition hover:bg-slate-800 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand">Panel general</button>
        <button data-tm-tab="definiciones" class="tab-button rounded-full px-4 py-2 transition hover:bg-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand">Definiciones de tareas</button>
        <button data-tm-tab="asignaciones" class="tab-button rounded-full px-4 py-2 transition hover:bg-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand">Asignaciones diarias</button>
        <button data-tm-tab="seguimiento" class="tab-button rounded-full px-4 py-2 transition hover:bg-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand">Seguimiento &amp; análisis</button>
        <button data-tm-tab="operario" class="tab-button rounded-full px-4 py-2 transition hover:bg-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand">Vista operario</button>
      </nav>

      <div class="space-y-12">
        <article data-tm-panel="panel" class="space-y-10">
          <div class="grid gap-6 lg:grid-cols-[minmax(0,1fr),24rem]">
            <section class="space-y-6">
              <header class="flex items-center justify-between">
                <div>
                  <h2 class="text-lg font-semibold text-slate-900">Estado general</h2>
                  <p class="text-sm text-slate-500">Resumen de cumplimiento, incidencias y backlog por granja.</p>
                </div>
                <button type="button" class="inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold text-slate-600 hover:border-brand hover:text-brand">
                  Exportar reporte
                </button>
              </header>
              <div class="grid gap-4 sm:grid-cols-2 xl:grid-cols-3">
                <div class="rounded-xl border border-slate-100 bg-slate-50/60 p-5">
                  <div class="flex items-center justify-between text-xs font-semibold uppercase tracking-wide text-slate-500">
                    <span>Backlog crítico</span>
                    <span class="rounded-full bg-rose-100 px-2 py-0.5 text-rose-700">12%</span>
                  </div>
                  <p class="mt-2 text-2xl font-bold text-rose-600">18 tareas</p>
                  <p class="mt-1 text-sm text-slate-600">Sin responsable asignado o con evidencia incompleta.</p>
                </div>
                <div class="rounded-xl border border-slate-100 bg-slate-50/60 p-5">
                  <div class="flex items-center justify-between text-xs font-semibold uppercase tracking-wide text-slate-500">
                    <span>Cumplimiento semanal</span>
                    <span class="rounded-full bg-emerald-100 px-2 py-0.5 text-emerald-700">+4 pp</span>
                  </div>
                  <p class="mt-2 text-2xl font-bold text-emerald-600">92%</p>
                  <p class="mt-1 text-sm text-slate-600">En comparación con la semana anterior.</p>
                </div>
                <div class="rounded-xl border border-slate-100 bg-slate-50/60 p-5 sm:col-span-2 xl:col-span-1">
                  <div class="flex items-center justify-between text-xs font-semibold uppercase tracking-wide text-slate-500">
                    <span>Alertas de evidencias</span>
                    <span class="rounded-full bg-amber-100 px-2 py-0.5 text-amber-700">Revisión</span>
                  </div>
                  <p class="mt-2 text-2xl font-bold text-amber-600">27 registros</p>
                  <p class="mt-1 text-sm text-slate-600">Solicitan verificación ocular o requieren fotografía adicional.</p>
                </div>
                <div class="rounded-xl border border-slate-100 bg-slate-50/60 p-5">
                  <div class="flex items-center justify-between text-xs font-semibold uppercase tracking-wide text-slate-500">
                    <span>Tareas reactivadas</span>
                    <span class="rounded-full bg-blue-100 px-2 py-0.5 text-blue-700">Pull de mejora</span>
                  </div>
                  <p class="mt-2 text-2xl font-bold text-blue-600">6 esta semana</p>
                  <p class="mt-1 text-sm text-slate-600">Duplicadas con indicaciones adicionales desde seguimiento.</p>
                </div>
              </div>

              <section class="rounded-xl border border-slate-100 bg-white p-6 shadow-sm">
                <header class="flex items-center justify-between gap-4">
                  <div>
                    <h3 class="text-base font-semibold text-slate-900">Agenda operativa</h3>
                    <p class="text-sm text-slate-500">Visualiza los focos por franjas horarias y turnos.</p>
                  </div>
                  <div class="flex items-center gap-2 text-xs text-slate-500">
                    <button type="button" class="rounded-full border border-slate-200 px-3 py-1 font-semibold hover:border-brand hover:text-brand">Hoy</button>
                    <button type="button" class="rounded-full border border-slate-200 px-3 py-1 font-semibold hover:border-brand hover:text-brand">Semana</button>
                    <button type="button" class="rounded-full border border-slate-200 px-3 py-1 font-semibold hover:border-brand hover:text-brand">Mes</button>
                  </div>
                </header>
                <div class="mt-6 grid gap-4 md:grid-cols-2">
                  <div class="rounded-lg border border-slate-100 bg-slate-50/60 p-4">
                    <h4 class="text-sm font-semibold text-slate-800">Mañana · Turno A</h4>
                    <ul class="mt-3 space-y-2 text-sm text-slate-600">
                      <li class="flex items-start justify-between rounded-lg bg-white/90 p-3 leading-snug shadow-sm">
                        <div>
                          <p class="font-semibold text-slate-800">Aplicar protocolo de bioseguridad</p>
                          <p class="text-xs text-slate-500">Granja El Guadual · Galpón 4</p>
                        </div>
                        <span class="rounded-full bg-brand/10 px-2 py-0.5 text-xs font-semibold text-brand">Prioridad Alta</span>
                      </li>
                      <li class="flex items-start justify-between rounded-lg bg-white/90 p-3 leading-snug shadow-sm">
                        <div>
                          <p class="font-semibold text-slate-800">Verificar inventario de alimento</p>
                          <p class="text-xs text-slate-500">Proceso general · Almacén</p>
                        </div>
                        <span class="rounded-full bg-emerald-100 px-2 py-0.5 text-xs font-semibold text-emerald-700">Al día</span>
                      </li>
                    </ul>
                  </div>
                  <div class="rounded-lg border border-slate-100 bg-slate-50/60 p-4">
                    <h4 class="text-sm font-semibold text-slate-800">Tarde · Turno B</h4>
                    <ul class="mt-3 space-y-2 text-sm text-slate-600">
                      <li class="flex items-start justify-between rounded-lg bg-white/90 p-3 leading-snug shadow-sm">
                        <div>
                          <p class="font-semibold text-slate-800">Limpieza profunda · Sala Incubación</p>
                          <p class="text-xs text-slate-500">Granja Altamira · Salón 2</p>
                        </div>
                        <span class="rounded-full bg-rose-100 px-2 py-0.5 text-xs font-semibold text-rose-700">Retraso</span>
                      </li>
                      <li class="flex items-start justify-between rounded-lg bg-white/90 p-3 leading-snug shadow-sm">
                        <div>
                          <p class="font-semibold text-slate-800">Reporte semanal de mortalidad</p>
                          <p class="text-xs text-slate-500">Proceso general · Indicadores</p>
                        </div>
                        <span class="rounded-full bg-amber-100 px-2 py-0.5 text-xs font-semibold text-amber-700">Requiere evidencia</span>
                      </li>
                    </ul>
                  </div>
                </div>
              </section>
            </section>

            <aside class="flex flex-col gap-5 rounded-xl border border-slate-100 bg-slate-50/40 p-5">
              <header>
                <h3 class="text-sm font-semibold uppercase tracking-wide text-slate-500">Alertas rápidas</h3>
                <p class="mt-1 text-sm text-slate-500">Identifica dónde actuar antes de que impacte la operación.</p>
              </header>
              <ul class="space-y-4 text-sm text-slate-600">
                <li class="rounded-lg border border-rose-200 bg-white/90 p-4 shadow-sm">
                  <div class="flex items-center justify-between">
                    <span class="font-semibold text-rose-600">3 tareas sin responsable</span>
                    <span class="rounded-full bg-rose-100 px-2 py-0.5 text-xs font-semibold text-rose-700">Crítico</span>
                  </div>
                  <p class="mt-2 text-xs text-slate-500">Granja La Rivera · Bioseguridad</p>
                  <button type="button" class="mt-3 inline-flex items-center gap-2 text-xs font-semibold text-rose-600 hover:text-rose-700">
                    Revisar y asignar
                    <span aria-hidden="true">→</span>
                  </button>
                </li>
                <li class="rounded-lg border border-amber-200 bg-white/90 p-4 shadow-sm">
                  <div class="flex items-center justify-between">
                    <span class="font-semibold text-amber-600">Evidencias pendientes</span>
                    <span class="rounded-full bg-amber-100 px-2 py-0.5 text-xs font-semibold text-amber-700">12 casos</span>
                  </div>
                  <p class="mt-2 text-xs text-slate-500">Validación requerida antes de cierre semanal.</p>
                  <button type="button" class="mt-3 inline-flex items-center gap-2 text-xs font-semibold text-amber-600 hover:text-amber-700">
                    Abrir bandeja de revisión
                    <span aria-hidden="true">→</span>
                  </button>
                </li>
                <li class="rounded-lg border border-emerald-200 bg-white/90 p-4 shadow-sm">
                  <div class="flex items-center justify-between">
                    <span class="font-semibold text-emerald-600">Sugerencias de operarios</span>
                    <span class="rounded-full bg-emerald-100 px-2 py-0.5 text-xs font-semibold text-emerald-700">8 nuevas</span>
                  </div>
                  <p class="mt-2 text-xs text-slate-500">Agrega valor a la operación incorporando sus propuestas.</p>
                  <button type="button" class="mt-3 inline-flex items-center gap-2 text-xs font-semibold text-emerald-600 hover:text-emerald-700">
                    Gestionar sugerencias
                    <span aria-hidden="true">→</span>
                  </button>
                </li>
              </ul>
            </aside>
          </div>
        </article>

        <article id="tm-definiciones" data-tm-panel="definiciones" class="hidden space-y-10">
          <div class="flex flex-col gap-6 lg:flex-row lg:items-start">
            <aside class="w-full rounded-xl border border-slate-100 bg-slate-50/40 p-5 lg:max-w-xs">
              <div class="flex items-center justify-between">
                <h2 class="text-base font-semibold text-slate-900">Filtros rápidos</h2>
                <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold text-slate-500 hover:border-brand hover:text-brand">Limpiar</button>
              </div>
              <form class="mt-5 space-y-5 text-sm text-slate-600">
                <fieldset class="space-y-2">
                  <legend class="text-xs font-semibold uppercase tracking-wide text-slate-500">Ámbito</legend>
                  <label class="flex items-center justify-between gap-2 rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <span>General</span>
                    <input type="checkbox" name="scope_general" class="rounded border-slate-300 text-brand focus:ring-brand" checked />
                  </label>
                  <label class="flex items-center justify-between gap-2 rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <span>Por granja</span>
                    <input type="checkbox" name="scope_farm" class="rounded border-slate-300 text-brand focus:ring-brand" checked />
                  </label>
                  <label class="flex items-center justify-between gap-2 rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <span>Por galpón</span>
                    <input type="checkbox" name="scope_house" class="rounded border-slate-300 text-brand focus:ring-brand" />
                  </label>
                  <label class="flex items-center justify-between gap-2 rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <span>Por salón</span>
                    <input type="checkbox" name="scope_room" class="rounded border-slate-300 text-brand focus:ring-brand" />
                  </label>
                </fieldset>

                <fieldset class="space-y-2">
                  <legend class="text-xs font-semibold uppercase tracking-wide text-slate-500">Categoría</legend>
                  <select class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20">
                    <option>Todas</option>
                    <option>Bioseguridad</option>
                    <option>Alimentación</option>
                    <option>Mantenimiento</option>
                    <option>Documentación</option>
                  </select>
                </fieldset>

                <fieldset class="space-y-2">
                  <legend class="text-xs font-semibold uppercase tracking-wide text-slate-500">Periodo</legend>
                  <label class="flex items-center gap-3 rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <input type="radio" name="period" value="all" class="border-slate-300 text-brand focus:ring-brand" checked />
                    <span>Todo</span>
                  </label>
                  <label class="flex items-center gap-3 rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <input type="radio" name="period" value="weekly" class="border-slate-300 text-brand focus:ring-brand" />
                    <span>Semanal</span>
                  </label>
                  <label class="flex items-center gap-3 rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <input type="radio" name="period" value="monthly" class="border-slate-300 text-brand focus:ring-brand" />
                    <span>Mensual</span>
                  </label>
                </fieldset>
                <fieldset class="space-y-2">
                  <legend class="text-xs font-semibold uppercase tracking-wide text-slate-500">Ordenar por</legend>
                  <select class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20">
                    <option>Prioridad (definida)</option>
                    <option>Fecha de creación</option>
                    <option>Más asignadas</option>
                    <option>Menor cumplimiento</option>
                  </select>
                </fieldset>
              </form>
            </aside>

            <section class="flex-1 space-y-6">
              <header class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
                <div>
                  <h2 class="text-lg font-semibold text-slate-900">Definiciones de tareas</h2>
                  <p class="text-sm text-slate-500">Administra plantillas y reglas de recurrencia por posición o colaborador sugerido.</p>
                </div>
                <div class="flex flex-wrap items-center gap-2 text-xs font-semibold text-slate-500">
                  <button type="button" class="rounded-full border border-slate-200 px-3 py-1 hover:border-brand hover:text-brand">Acciones masivas</button>
                  <button type="button" class="rounded-full border border-slate-200 px-3 py-1 hover:border-brand hover:text-brand">Duplicar</button>
                  <button type="button" class="rounded-full border border-slate-200 px-3 py-1 hover:border-brand hover:text-brand">Descartar</button>
                  <button type="button" class="rounded-full border border-brand bg-brand px-3 py-1 text-white hover:bg-brand-dark">Nueva definición</button>
                </div>
              </header>
              <div class="overflow-hidden rounded-xl border border-slate-200">
                <table class="min-w-full divide-y divide-slate-200 text-sm">
                  <thead class="bg-slate-50 text-xs uppercase tracking-wide text-slate-500">
                    <tr>
                      <th scope="col" class="px-4 py-3 text-left font-semibold">Nombre</th>
                      <th scope="col" class="px-4 py-3 text-left font-semibold">Ámbito</th>
                      <th scope="col" class="px-4 py-3 text-left font-semibold">Tipo</th>
                      <th scope="col" class="px-4 py-3 text-left font-semibold">Posición sugerida</th>
                      <th scope="col" class="px-4 py-3 text-left font-semibold">Recurrencia</th>
                      <th scope="col" class="px-4 py-3 text-left font-semibold">Evidencia</th>
                      <th scope="col" class="px-4 py-3 text-left font-semibold">Acciones</th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-slate-100 bg-white text-slate-700">
                    <tr class="hover:bg-slate-50/80">
                      <td class="px-4 py-4">
                        <div class="font-semibold text-slate-900">Control de acceso</div>
                        <div class="text-xs text-slate-500">Revisión de visitantes y bitácora diaria.</div>
                      </td>
                      <td class="px-4 py-4">
                        <div class="inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600">
                          <span class="h-2 w-2 rounded-full bg-emerald-500"></span>
                          Granja El Guadual
                        </div>
                      </td>
                      <td class="px-4 py-4 text-xs font-medium text-slate-600">Recurrente</td>
                      <td class="px-4 py-4 text-xs text-slate-600">Supervisor Bioseguridad</td>
                      <td class="px-4 py-4 text-xs text-slate-600">
                        Lunes · Miércoles · Viernes<br />
                        1 y 15 de cada mes
                      </td>
                      <td class="px-4 py-4 text-xs font-semibold text-emerald-600">Requiere foto</td>
                      <td class="px-4 py-4">
                        <div class="flex flex-wrap gap-2 text-xs font-semibold">
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Editar</button>
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Programar</button>
                          <button type="button" class="rounded-full border border-rose-200 px-3 py-1 text-rose-600 hover:border-rose-300 hover:text-rose-700">Archivar</button>
                        </div>
                      </td>
                    </tr>
                    <tr class="hover:bg-slate-50/80">
                      <td class="px-4 py-4">
                        <div class="font-semibold text-slate-900">Revisión de bebederos</div>
                        <div class="text-xs text-slate-500">Ajustar flujo y sanitizar rejillas.</div>
                      </td>
                      <td class="px-4 py-4">
                        <div class="inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600">
                          <span class="h-2 w-2 rounded-full bg-sky-500"></span>
                          Galpón 3 · Altamira
                        </div>
                      </td>
                      <td class="px-4 py-4 text-xs font-medium text-slate-600">Recurrente</td>
                      <td class="px-4 py-4 text-xs text-slate-600">Líder de turno</td>
                      <td class="px-4 py-4 text-xs text-slate-600">
                        Todos los días
                      </td>
                      <td class="px-4 py-4 text-xs font-semibold text-slate-500">Opcional</td>
                      <td class="px-4 py-4">
                        <div class="flex flex-wrap gap-2 text-xs font-semibold">
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Editar</button>
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Duplicar</button>
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Ver historial asignaciones</button>
                        </div>
                      </td>
                    </tr>
                    <tr class="hover:bg-slate-50/80">
                      <td class="px-4 py-4">
                        <div class="font-semibold text-slate-900">Reporte semanal productividad</div>
                        <div class="text-xs text-slate-500">Consolidar indicadores de mortalidad y conversión.</div>
                      </td>
                      <td class="px-4 py-4">
                        <div class="inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600">
                          <span class="h-2 w-2 rounded-full bg-purple-500"></span>
                          Proceso general
                        </div>
                      </td>
                      <td class="px-4 py-4 text-xs font-medium text-slate-600">Única</td>
                      <td class="px-4 py-4 text-xs text-slate-600">Coordinador producción</td>
                      <td class="px-4 py-4 text-xs text-slate-600">
                        05/11/2025
                      </td>
                      <td class="px-4 py-4 text-xs font-semibold text-amber-600">Documento PDF</td>
                      <td class="px-4 py-4">
                        <div class="flex flex-wrap gap-2 text-xs font-semibold">
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Editar</button>
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Asignar</button>
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Ver evidencia</button>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </section>
          </div>

          <section class="grid gap-6 lg:grid-cols-[minmax(0,1.4fr),minmax(0,1fr)]">
            <form class="rounded-xl border border-slate-200 bg-white p-6 shadow-sm">
              <header class="flex items-center justify-between">
                <div>
                  <h3 class="text-base font-semibold text-slate-900">Nueva definición</h3>
                  <p class="text-sm text-slate-500">Configura los parámetros que se conectarán con el calendario operativo.</p>
                </div>
                <span class="rounded-full bg-brand/10 px-3 py-1 text-xs font-semibold text-brand">Paso 1/2</span>
              </header>
              <div class="mt-6 grid gap-5 sm:grid-cols-2">
                <label class="text-sm font-medium text-slate-700">
                  Nombre de la tarea
                  <input type="text" class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20" placeholder="Ej. Sanitizar equipos de pesaje" />
                </label>
                <label class="text-sm font-medium text-slate-700">
                  Categoría
                  <select class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20">
                    <option>Seleccione</option>
                    <option>Bioseguridad</option>
                    <option>Mantenimiento</option>
                    <option>Producción</option>
                    <option>Documentación</option>
                  </select>
                </label>
                <label class="text-sm font-medium text-slate-700 sm:col-span-2">
                  Descripción
                  <textarea rows="3" class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20" placeholder="Detalla la rutina, estándares y protocolos a cumplir."></textarea>
                </label>
                <div class="sm:col-span-2">
                  <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Recurrencia</p>
                  <div class="mt-2 grid gap-3 sm:grid-cols-3">
                    <label class="flex items-center justify-between gap-3 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm font-medium text-slate-700">
                      Única
                      <input type="radio" name="task_type" class="border-slate-300 text-brand focus:ring-brand" />
                    </label>
                    <label class="flex items-center justify-between gap-3 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm font-medium text-slate-700">
                      Semanal
                      <input type="radio" name="task_type" class="border-slate-300 text-brand focus:ring-brand" checked />
                    </label>
                    <label class="flex items-center justify-between gap-3 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm font-medium text-slate-700">
                      Mensual
                      <input type="radio" name="task_type" class="border-slate-300 text-brand focus:ring-brand" />
                    </label>
                  </div>
                </div>
                <div class="sm:col-span-2">
                  <label class="text-sm font-medium text-slate-700">
                    Días / Fechas
                    <input type="text" class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20" placeholder="Lunes, Miércoles, Viernes · 1 y 15" />
                  </label>
                  <p class="mt-1 text-xs text-slate-500">El sistema validará que las configuraciones sean coherentes con el tipo de tarea.</p>
                </div>
                <label class="text-sm font-medium text-slate-700">
                  Posición prioritaria
                  <select class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20">
                    <option>Seleccione</option>
                    <option>Auxiliar Operativo</option>
                    <option>Líder de turno</option>
                    <option>Supervisor Bioseguridad</option>
                    <option>Coordinador Producción</option>
                  </select>
                </label>
                <label class="text-sm font-medium text-slate-700">
                  Colaborador sugerido
                  <select class="mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-700 focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20">
                    <option>Automático según posición</option>
                    <option>Diana Bustos</option>
                    <option>Jhon Vergara</option>
                    <option>María Perdomo</option>
                  </select>
                </label>
                <div class="sm:col-span-2">
                  <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Requisitos adicionales</p>
                  <div class="mt-3 space-y-3">
                    <label class="flex items-center gap-3 text-sm text-slate-700">
                      <input type="checkbox" class="rounded border-slate-300 text-brand focus:ring-brand" checked />
                      Requiere foto de evidencia
                    </label>
                    <label class="flex items-center gap-3 text-sm text-slate-700">
                      <input type="checkbox" class="rounded border-slate-300 text-brand focus:ring-brand" />
                      Solicitar nota de cierre
                    </label>
                    <label class="flex items-center gap-3 text-sm text-slate-700">
                      <input type="checkbox" class="rounded border-slate-300 text-brand focus:ring-brand" />
                      Bloquear postergación superior a 24h
                    </label>
                  </div>
                </div>
              </div>
              <div class="mt-6 flex flex-wrap justify-between gap-3 border-t border-slate-100 pt-4">
                <button type="button" class="rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-600 hover:border-brand hover:text-brand">Guardar borrador</button>
                <div class="flex flex-wrap gap-2">
                  <button type="button" class="rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-600 hover:border-brand hover:text-brand">Cancelar</button>
                  <button type="button" class="rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white shadow hover:bg-brand-dark">Continuar a asignación</button>
                </div>
              </div>
            </form>

            <aside class="space-y-5 rounded-xl border border-slate-100 bg-slate-50/40 p-6">
              <h3 class="text-base font-semibold text-slate-900">Plantillas destacadas</h3>
              <div class="space-y-4 text-sm text-slate-600">
                <article class="rounded-lg border border-slate-200 bg-white p-4 shadow-sm">
                  <header class="flex items-start justify-between">
                    <div>
                      <h4 class="text-sm font-semibold text-slate-900">Checklist de apertura</h4>
                      <p class="text-xs text-slate-500">Se ejecuta al inicio de cada turno para verificar condiciones.</p>
                    </div>
                    <span class="rounded-full bg-emerald-100 px-2 py-0.5 text-xs font-semibold text-emerald-700">96% cumplimiento</span>
                  </header>
                  <ul class="mt-3 space-y-1 text-xs text-slate-500">
                    <li>Turno diurno · Auxiliar Operativo</li>
                    <li>Sin evidencia fotográfica obligatoria</li>
                    <li>Recurrencia diaria · Prioridad media</li>
                  </ul>
                  <div class="mt-4 flex flex-wrap gap-2 text-xs font-semibold">
                    <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Ver detalles</button>
                    <button type="button" class="rounded-full border border-brand bg-brand px-3 py-1 text-white hover:bg-brand-dark">Usar como base</button>
                  </div>
                </article>
                <article class="rounded-lg border border-slate-200 bg-white p-4 shadow-sm">
                  <header class="flex items-start justify-between">
                    <div>
                      <h4 class="text-sm font-semibold text-slate-900">Control fitosanitario semanal</h4>
                      <p class="text-xs text-slate-500">Integra monitoreo con captura obligatoria de evidencia.</p>
                    </div>
                    <span class="rounded-full bg-rose-100 px-2 py-0.5 text-xs font-semibold text-rose-700">Bajo cumplimiento</span>
                  </header>
                  <ul class="mt-3 space-y-1 text-xs text-slate-500">
                    <li>Granja Altamira · Galpón 2</li>
                    <li>Requiere foto y nota de cierre</li>
                    <li>Recurrencia semanal · Prioridad alta</li>
                  </ul>
                  <div class="mt-4 flex flex-wrap gap-2 text-xs font-semibold">
                    <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Reasignar</button>
                    <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Ver historial</button>
                  </div>
                </article>
              </div>

              <div class="rounded-lg border border-dashed border-slate-300 bg-white/80 p-4 text-xs text-slate-500">
                <p class="font-semibold text-slate-600">Recordatorio:</p>
                <p class="mt-1">
                  Las reglas de recurrencia deben validar solapamientos con otros calendarios operativos. El sistema sugerirá reasignaciones cuando detecte conflicto de fechas o posiciones inactivas.
                </p>
              </div>
            </aside>
          </section>
        </article>

        <article id="tm-asignaciones" data-tm-panel="asignaciones" class="hidden space-y-8">
          <header class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
            <div>
              <h2 class="text-lg font-semibold text-slate-900">Planificador de asignaciones</h2>
              <p class="text-sm text-slate-500">Organiza quién ejecuta cada tarea por día y posición, sincronizado con el calendario operativo.</p>
            </div>
            <div class="flex flex-wrap items-center gap-2 text-xs font-semibold text-slate-500">
              <button type="button" class="rounded-full border border-slate-200 px-3 py-1 hover:border-brand hover:text-brand">Importar desde CSV</button>
              <button type="button" class="rounded-full border border-slate-200 px-3 py-1 hover:border-brand hover:text-brand">Generar automáticamente</button>
              <button type="button" class="rounded-full border border-slate-200 px-3 py-1 hover:border-brand hover:text-brand">Validar conflictos</button>
              <button type="button" class="rounded-full bg-brand px-3 py-1 text-white hover:bg-brand-dark">Publicar semana</button>
            </div>
          </header>

          <section class="rounded-xl border border-slate-200 bg-white p-5 shadow-sm">
            <div class="flex flex-col gap-4 lg:flex-row lg:items-end lg:justify-between">
              <div class="flex flex-wrap items-center gap-3 text-sm text-slate-600">
                <label class="flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2">
                  <span class="text-xs font-semibold uppercase tracking-wide text-slate-500">Semana</span>
                  <input type="date" class="rounded border border-slate-200 px-2 py-1 text-sm focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20" value="2025-11-03" />
                </label>
                <select class="rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20">
                  <option>Todas las granjas</option>
                  <option>El Guadual</option>
                  <option>La Rivera</option>
                  <option>Altamira</option>
                </select>
                <select class="rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20">
                  <option>Todos los galpones</option>
                  <option>Galpón 1</option>
                  <option>Galpón 2</option>
                  <option>Galpón 3</option>
                </select>
                <select class="rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20">
                  <option>Todos los estados</option>
                  <option>Asignadas</option>
                  <option>Sin responsable</option>
                  <option>Con observaciones</option>
                </select>
              </div>
              <div class="flex items-center gap-2 text-xs text-slate-500">
                <button type="button" class="rounded-full border border-slate-200 px-3 py-1 font-semibold hover:border-brand hover:text-brand">Turno diurno</button>
                <button type="button" class="rounded-full border border-slate-200 px-3 py-1 font-semibold hover:border-brand hover:text-brand">Turno nocturno</button>
                <button type="button" class="rounded-full border border-brand bg-brand px-3 py-1 font-semibold text-white hover:bg-brand-dark">Ver ambos</button>
              </div>
            </div>

            <div class="mt-6 overflow-x-auto">
              <table class="min-w-full text-sm">
                <thead class="bg-slate-50 text-xs uppercase tracking-wide text-slate-500">
                  <tr>
                    <th class="min-w-[220px] px-4 py-3 text-left font-semibold">Posición</th>
                    <th class="px-4 py-3 text-left font-semibold">Lun 03</th>
                    <th class="px-4 py-3 text-left font-semibold">Mar 04</th>
                    <th class="px-4 py-3 text-left font-semibold">Mié 05</th>
                    <th class="px-4 py-3 text-left font-semibold">Jue 06</th>
                    <th class="px-4 py-3 text-left font-semibold">Vie 07</th>
                    <th class="px-4 py-3 text-left font-semibold">Sáb 08</th>
                    <th class="px-4 py-3 text-left font-semibold">Dom 09</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-slate-100">
                  <tr class="bg-white">
                    <td class="px-4 py-3">
                      <div class="font-semibold text-slate-900">Supervisor Bioseguridad</div>
                      <p class="text-xs text-slate-500">Prioridad máxima · Turno diurno</p>
                    </td>
                    <td class="alignment-cell">
                      <div class="tm-assignment-card bg-brand/10">
                        <p class="font-semibold text-slate-900">Control de acceso</p>
                        <p class="text-xs text-slate-500">Diana Bustos</p>
                        <div class="tm-assignment-actions">
                          <button type="button">Reasignar</button>
                          <button type="button">Ver detalle</button>
                        </div>
                      </div>
                    </td>
                    <td class="alignment-cell">
                      <div class="tm-assignment-card bg-emerald-50">
                        <p class="font-semibold text-slate-900">Control de acceso</p>
                        <p class="text-xs text-slate-500">Diana Bustos</p>
                        <div class="tm-assignment-actions">
                          <button type="button">Reasignar</button>
                          <button type="button">Registrar descanso</button>
                        </div>
                      </div>
                    </td>
                    <td class="alignment-cell">
                      <div class="tm-assignment-card bg-slate-100">
                        <p class="font-semibold text-slate-900">Control de acceso</p>
                        <p class="text-xs text-slate-500">Disponible</p>
                        <div class="tm-assignment-actions">
                          <button type="button">Asignar</button>
                          <button type="button">Buscar sugeridos</button>
                        </div>
                      </div>
                    </td>
                    <td class="alignment-cell">
                      <div class="tm-assignment-card bg-rose-100">
                        <p class="font-semibold text-slate-900">Control de acceso</p>
                        <p class="text-xs text-rose-600">Conflicto: descanso automático</p>
                        <div class="tm-assignment-actions">
                          <button type="button">Resolver</button>
                          <button type="button">Reprogramar</button>
                        </div>
                      </div>
                    </td>
                    <td class="alignment-cell">
                      <div class="tm-assignment-card bg-brand/10">
                        <p class="font-semibold text-slate-900">Control de acceso</p>
                        <p class="text-xs text-slate-500">Diana Bustos</p>
                        <div class="tm-assignment-actions">
                          <button type="button">Reasignar</button>
                          <button type="button">Marcar descanso</button>
                        </div>
                      </div>
                    </td>
                    <td class="alignment-cell">
                      <div class="tm-assignment-card bg-slate-50">
                        <p class="font-semibold text-slate-900">Control de acceso</p>
                        <p class="text-xs text-slate-500">Disponible</p>
                        <div class="tm-assignment-actions">
                          <button type="button">Asignar</button>
                          <button type="button">Duplicar</button>
                        </div>
                      </div>
                    </td>
                    <td class="alignment-cell">
                      <div class="tm-assignment-card bg-emerald-50">
                        <p class="font-semibold text-slate-900">Control de acceso</p>
                        <p class="text-xs text-slate-500">Automático</p>
                        <div class="tm-assignment-actions">
                          <button type="button">Confirmar</button>
                          <button type="button">Bloquear</button>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr class="bg-white">
                    <td class="px-4 py-3">
                      <div class="font-semibold text-slate-900">Auxiliar Operativo · Galpón 3</div>
                      <p class="text-xs text-slate-500">Turno nocturno</p>
                    </td>
                    <td class="alignment-cell">
                      <div class="tm-assignment-card bg-slate-50">
                        <p class="font-semibold text-slate-900">Revisión de bebederos</p>
                        <p class="text-xs text-slate-500">Luis Ariza</p>
                        <div class="tm-assignment-actions">
                          <button type="button">Reasignar</button>
                          <button type="button">Ver historial</button>
                        </div>
                      </div>
                    </td>
                    <td class="alignment-cell">
                      <div class="tm-assignment-card bg-slate-50">
                        <p class="font-semibold text-slate-900">Revisión de bebederos</p>
                        <p class="text-xs text-slate-500">Luis Ariza</p>
                        <div class="tm-assignment-actions">
                          <button type="button">Reasignar</button>
                          <button type="button">Registrar descanso</button>
                        </div>
                      </div>
                    </td>
                    <td class="alignment-cell">
                      <div class="tm-assignment-card bg-rose-100">
                        <p class="font-semibold text-slate-900">Revisión de bebederos</p>
                        <p class="text-xs text-rose-600">Descanso obligatorio</p>
                        <div class="tm-assignment-actions">
                          <button type="button">Liberar</button>
                          <button type="button">Buscar reemplazo</button>
                        </div>
                      </div>
                    </td>
                    <td class="alignment-cell">
                      <div class="tm-assignment-card bg-slate-100">
                        <p class="font-semibold text-slate-900">Revisión de bebederos</p>
                        <p class="text-xs text-slate-500">Disponible</p>
                        <div class="tm-assignment-actions">
                          <button type="button">Asignar</button>
                          <button type="button">Sugeridos</button>
                        </div>
                      </div>
                    </td>
                    <td class="alignment-cell">
                      <div class="tm-assignment-card bg-slate-100">
                        <p class="font-semibold text-slate-900">Revisión de bebederos</p>
                        <p class="text-xs text-slate-500">Disponible</p>
                        <div class="tm-assignment-actions">
                          <button type="button">Asignar</button>
                          <button type="button">Duplicar</button>
                        </div>
                      </div>
                    </td>
                    <td class="alignment-cell tm-blank">
                      <div class="rounded-lg border border-dashed border-slate-200 bg-slate-50/60 p-3 text-xs text-slate-400">
                        Arrastra una tarea o genera sugerencia automática.
                      </div>
                    </td>
                    <td class="alignment-cell tm-blank">
                      <div class="rounded-lg border border-dashed border-slate-200 bg-slate-50/60 p-3 text-xs text-slate-400">
                        Arrastra una tarea o genera sugerencia automática.
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="mt-6 grid gap-4 md:grid-cols-3">
              <div class="rounded-lg border border-slate-200 bg-slate-50/70 p-4 text-sm text-slate-600">
                <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Conflictos detectados</p>
                <p class="mt-1 text-lg font-semibold text-rose-600">4 asignaciones</p>
                <p class="mt-2 text-xs text-slate-500">Resuelve solapamientos de posiciones, descansos obligatorios y tareas duplicadas.</p>
              </div>
              <div class="rounded-lg border border-slate-200 bg-slate-50/70 p-4 text-sm text-slate-600">
                <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Colaboradores con sobrecarga</p>
                <p class="mt-1 text-lg font-semibold text-amber-600">2 personas</p>
                <p class="mt-2 text-xs text-slate-500">Rotación día/noche sugerida para balancear rachas de turnos.</p>
              </div>
              <div class="rounded-lg border border-slate-200 bg-slate-50/70 p-4 text-sm text-slate-600">
                <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Tareas sin responsable</p>
                <p class="mt-1 text-lg font-semibold text-slate-900">5 pendientes</p>
                <p class="mt-2 text-xs text-slate-500">Utiliza la búsqueda inteligente para sugerir nominados según historial.</p>
              </div>
            </div>
          </section>

          <section class="grid gap-6 lg:grid-cols-[minmax(0,1fr),22rem]">
            <div class="rounded-xl border border-slate-200 bg-white p-6 shadow-sm">
              <header class="flex items-center justify-between">
                <div>
                  <h3 class="text-base font-semibold text-slate-900">Bandeja de sugerencias automáticas</h3>
                  <p class="text-sm text-slate-500">Basadas en historial de asignaciones y descansos programados.</p>
                </div>
                <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold text-slate-600 hover:border-brand hover:text-brand">Aplicar todo</button>
              </header>
              <ul class="mt-5 space-y-4 text-sm text-slate-600">
                <li class="tm-suggestion">
                  <div>
                    <p class="font-semibold text-slate-900">Asignar limpieza profunda</p>
                    <p class="text-xs text-slate-500">Se sugiere a <strong>Gabriela Melo</strong> por especialidad y descanso reciente.</p>
                  </div>
                  <div class="tm-suggestion-actions">
                    <button type="button">Revisar</button>
                    <button type="button">Aplicar</button>
                  </div>
                </li>
                <li class="tm-suggestion">
                  <div>
                    <p class="font-semibold text-slate-900">Mover reporte de mortalidad</p>
                    <p class="text-xs text-slate-500">Conflicto con capacitación, sugiera trasladar a <strong>Jesús Prada</strong>.</p>
                  </div>
                  <div class="tm-suggestion-actions">
                    <button type="button">Ver conflicto</button>
                    <button type="button">Reasignar</button>
                  </div>
                </li>
                <li class="tm-suggestion">
                  <div>
                    <p class="font-semibold text-slate-900">Agregar descanso compensatorio</p>
                    <p class="text-xs text-slate-500">Luis Ariza acumula 6 días consecutivos. Sugerido descanso el jueves.</p>
                  </div>
                  <div class="tm-suggestion-actions">
                    <button type="button">Ver racha</button>
                    <button type="button">Programar</button>
                  </div>
                </li>
              </ul>
            </div>
            <aside class="space-y-4 rounded-xl border border-slate-100 bg-slate-50/40 p-5 text-sm text-slate-600">
              <div>
                <h4 class="text-sm font-semibold text-slate-900">Resumen por colaborador</h4>
                <ul class="mt-3 space-y-3">
                  <li class="flex items-center justify-between rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <div>
                      <p class="font-semibold text-slate-800">Diana Bustos</p>
                      <p class="text-xs text-slate-500">4 tareas · 1 descanso</p>
                    </div>
                    <span class="rounded-full bg-emerald-100 px-2 py-0.5 text-xs font-semibold text-emerald-700">Balanceado</span>
                  </li>
                  <li class="flex items-center justify-between rounded-lg border border-amber-200 bg-white px-3 py-2">
                    <div>
                      <p class="font-semibold text-slate-800">Luis Ariza</p>
                      <p class="text-xs text-amber-600">6 días consecutivos</p>
                    </div>
                    <span class="rounded-full bg-amber-100 px-2 py-0.5 text-xs font-semibold text-amber-700">Atención</span>
                  </li>
                  <li class="flex items-center justify-between rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <div>
                      <p class="font-semibold text-slate-800">María Perdomo</p>
                      <p class="text-xs text-slate-500">3 tareas · 2 descansos</p>
                    </div>
                    <span class="rounded-full bg-slate-100 px-2 py-0.5 text-xs font-semibold text-slate-600">Rotación sugerida</span>
                  </li>
                </ul>
              </div>
              <div>
                <h4 class="text-sm font-semibold text-slate-900">Tareas en espera</h4>
                <ul class="mt-3 space-y-2">
                  <li class="rounded-lg border border-dashed border-slate-300 bg-white px-3 py-2 text-xs text-slate-500">
                    Desinfección salas — asignar antes del viernes.
                  </li>
                  <li class="rounded-lg border border-dashed border-slate-300 bg-white px-3 py-2 text-xs text-slate-500">
                    Auditoría inventario alimento — requiere líder disponible sábado.
                  </li>
                  <li class="rounded-lg border border-dashed border-slate-300 bg-white px-3 py-2 text-xs text-slate-500">
                    Revisión cámaras seguridad — pendiente confirmación proveedor.
                  </li>
                </ul>
              </div>
            </aside>
          </section>
        </article>

        <article id="tm-seguimiento" data-tm-panel="seguimiento" class="hidden space-y-10">
          <header class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
            <div>
              <h2 class="text-lg font-semibold text-slate-900">Seguimiento &amp; análisis</h2>
              <p class="text-sm text-slate-500">Controla estados, evidencia, reactivaciones y puntajes de cumplimiento.</p>
            </div>
            <div class="flex flex-wrap items-center gap-2 text-xs font-semibold text-slate-500">
              <button type="button" class="rounded-full border border-slate-200 px-3 py-1 hover:border-brand hover:text-brand">Ver modo tablero</button>
              <button type="button" class="rounded-full border border-slate-200 px-3 py-1 hover:border-brand hover:text-brand">Comparar vs semana anterior</button>
              <button type="button" class="rounded-full border border-brand bg-brand px-3 py-1 text-white hover:bg-brand-dark">Generar PDF</button>
            </div>
          </header>

          <section class="grid gap-6 xl:grid-cols-[minmax(0,1.2fr),minmax(0,1fr)]">
            <div class="space-y-6 rounded-xl border border-slate-200 bg-white p-6 shadow-sm">
              <header class="flex flex-wrap items-center justify-between gap-3">
                <div>
                  <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Estado de cumplimiento</p>
                  <p class="text-3xl font-bold text-slate-900">78% en curso</p>
                </div>
                <div class="flex items-center gap-2 text-xs text-slate-500">
                  <label class="flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1">
                    <span>Periodo</span>
                    <select class="rounded border border-slate-200 bg-transparent px-2 py-1 text-xs focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20">
                      <option>Semana actual</option>
                      <option>Mes actual</option>
                      <option>Últimos 90 días</option>
                    </select>
                  </label>
                </div>
              </header>

              <div class="grid gap-4 md:grid-cols-2">
                <div class="rounded-lg border border-slate-100 bg-slate-50/60 p-4 text-sm text-slate-600">
                  <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Completadas</p>
                  <p class="mt-1 text-xl font-bold text-emerald-600">284 tareas</p>
                  <p class="mt-3 text-xs text-slate-500">El 60% con evidencia aprobada, 40% en revisión.</p>
                </div>
                <div class="rounded-lg border border-slate-100 bg-slate-50/60 p-4 text-sm text-slate-600">
                  <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">En proceso</p>
                  <p class="mt-1 text-xl font-bold text-amber-600">62 tareas</p>
                  <p class="mt-3 text-xs text-slate-500">Esperan cierre antes de medianoche o prueba fotográfica.</p>
                </div>
                <div class="rounded-lg border border-slate-100 bg-slate-50/60 p-4 text-sm text-slate-600">
                  <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Postergadas</p>
                  <p class="mt-1 text-xl font-bold text-blue-600">18 tareas</p>
                  <p class="mt-3 text-xs text-slate-500">Necesitan justificativo y nueva fecha antes de 24h.</p>
                </div>
                <div class="rounded-lg border border-slate-100 bg-slate-50/60 p-4 text-sm text-slate-600">
                  <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Reactivadas</p>
                  <p class="mt-1 text-xl font-bold text-rose-600">9 tareas</p>
                  <p class="mt-3 text-xs text-slate-500">Regresaron al backlog con anotaciones específicas.</p>
                </div>
              </div>

              <div class="overflow-hidden rounded-lg border border-slate-200">
                <table class="min-w-full divide-y divide-slate-200 text-sm">
                  <thead class="bg-slate-50 text-xs uppercase tracking-wide text-slate-500">
                    <tr>
                      <th scope="col" class="px-4 py-3 text-left font-semibold">Tarea</th>
                      <th scope="col" class="px-4 py-3 text-left font-semibold">Asignado a</th>
                      <th scope="col" class="px-4 py-3 text-left font-semibold">Estado</th>
                      <th scope="col" class="px-4 py-3 text-left font-semibold">Evidencia</th>
                      <th scope="col" class="px-4 py-3 text-left font-semibold">Acciones</th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-slate-100 bg-white text-slate-700">
                    <tr class="hover:bg-slate-50/80">
                      <td class="px-4 py-4">
                        <p class="font-semibold text-slate-900">Informe semanal de mortalidad</p>
                        <p class="text-xs text-slate-500">Granja Altamira · Proceso general</p>
                      </td>
                      <td class="px-4 py-4 text-xs text-slate-600">
                        <div class="font-semibold text-slate-800">María Perdomo</div>
                        <p>Turno diurno · Posición coordinador</p>
                      </td>
                      <td class="px-4 py-4">
                        <span class="rounded-full bg-amber-100 px-3 py-1 text-xs font-semibold text-amber-700">En revisión</span>
                      </td>
                      <td class="px-4 py-4 text-xs text-slate-600">
                        <p>Documento cargado · Comentario pendiente</p>
                        <button type="button" class="mt-2 inline-flex items-center gap-2 text-xs font-semibold text-brand hover:text-brand-dark">
                          Solicitar aclaración
                          <span aria-hidden="true">→</span>
                        </button>
                      </td>
                      <td class="px-4 py-4">
                        <div class="flex flex-wrap gap-2 text-xs font-semibold">
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Validar</button>
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Reactivar</button>
                        </div>
                      </td>
                    </tr>
                    <tr class="hover:bg-slate-50/80">
                      <td class="px-4 py-4">
                        <p class="font-semibold text-slate-900">Desinfección de equipos</p>
                        <p class="text-xs text-slate-500">Galpón 4 · El Guadual</p>
                      </td>
                      <td class="px-4 py-4 text-xs text-slate-600">
                        <div class="font-semibold text-slate-800">Jhon Vergara</div>
                        <p>Turno nocturno · Auxiliar Operativo</p>
                      </td>
                      <td class="px-4 py-4">
                        <span class="rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700">Completada</span>
                      </td>
                      <td class="px-4 py-4 text-xs text-slate-600">
                        <p>Foto verificada · Nota de cierre agregada</p>
                        <button type="button" class="mt-2 inline-flex items-center gap-2 text-xs font-semibold text-brand hover:text-brand-dark">
                          Ver evidencia
                          <span aria-hidden="true">→</span>
                        </button>
                      </td>
                      <td class="px-4 py-4">
                        <div class="flex flex-wrap gap-2 text-xs font-semibold">
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Reconocer</button>
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Duplicar</button>
                        </div>
                      </td>
                    </tr>
                    <tr class="hover:bg-slate-50/80">
                      <td class="px-4 py-4">
                        <p class="font-semibold text-slate-900">Inspección fitosanitaria</p>
                        <p class="text-xs text-slate-500">Granja La Rivera · Galpón 1</p>
                      </td>
                      <td class="px-4 py-4 text-xs text-slate-600">
                        <div class="font-semibold text-slate-800">Gabriela Melo</div>
                        <p>Turno diurno · Supervisora</p>
                      </td>
                      <td class="px-4 py-4">
                        <span class="rounded-full bg-rose-100 px-3 py-1 text-xs font-semibold text-rose-700">Reactivada</span>
                      </td>
                      <td class="px-4 py-4 text-xs text-slate-600">
                        <p>Observación: hallazgos sin corregir.</p>
                        <button type="button" class="mt-2 inline-flex items-center gap-2 text-xs font-semibold text-brand hover:text-brand-dark">
                          Ver comentarios
                          <span aria-hidden="true">→</span>
                        </button>
                      </td>
                      <td class="px-4 py-4">
                        <div class="flex flex-wrap gap-2 text-xs font-semibold">
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Reasignar</button>
                          <button type="button" class="rounded-full border border-slate-200 px-3 py-1 text-slate-600 hover:border-brand hover:text-brand">Cerrar con nota</button>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <aside class="space-y-6 rounded-xl border border-slate-100 bg-slate-50/40 p-6 text-sm text-slate-600">
              <section>
                <h3 class="text-sm font-semibold text-slate-900">Rendimiento por granja</h3>
                <ul class="mt-3 space-y-3">
                  <li class="rounded-lg border border-slate-200 bg-white p-4">
                    <div class="flex items-center justify-between">
                      <span class="font-semibold text-slate-800">El Guadual</span>
                      <span class="rounded-full bg-emerald-100 px-2 py-0.5 text-xs font-semibold text-emerald-700">95%</span>
                    </div>
                    <p class="mt-2 text-xs text-slate-500">Foco en tareas recurrentes · 2 reactivadas.</p>
                  </li>
                  <li class="rounded-lg border border-slate-200 bg-white p-4">
                    <div class="flex items-center justify-between">
                      <span class="font-semibold text-slate-800">Altamira</span>
                      <span class="rounded-full bg-amber-100 px-2 py-0.5 text-xs font-semibold text-amber-700">81%</span>
                    </div>
                    <p class="mt-2 text-xs text-slate-500">Alto volumen de evidencias pendientes.</p>
                  </li>
                  <li class="rounded-lg border border-slate-200 bg-white p-4">
                    <div class="flex items-center justify-between">
                      <span class="font-semibold text-slate-800">La Rivera</span>
                      <span class="rounded-full bg-rose-100 px-2 py-0.5 text-xs font-semibold text-rose-700">69%</span>
                    </div>
                    <p class="mt-2 text-xs text-slate-500">Requiere soporte en bioseguridad y capacitación.</p>
                  </li>
                </ul>
              </section>
              <section>
                <h3 class="text-sm font-semibold text-slate-900">Puntos y consistencia</h3>
                <ul class="mt-3 space-y-3">
                  <li class="flex items-center justify-between rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <div>
                      <p class="font-semibold text-slate-800">María Perdomo</p>
                      <p class="text-xs text-slate-500">Puntos: 185 · Racha: 12 días cumplidos</p>
                    </div>
                    <span class="rounded-full bg-emerald-100 px-2 py-0.5 text-xs font-semibold text-emerald-700">Excelente</span>
                  </li>
                  <li class="flex items-center justify-between rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <div>
                      <p class="font-semibold text-slate-800">Luis Ariza</p>
                      <p class="text-xs text-slate-500">Puntos: 122 · Racha: 6 días</p>
                    </div>
                    <span class="rounded-full bg-amber-100 px-2 py-0.5 text-xs font-semibold text-amber-700">Atención</span>
                  </li>
                  <li class="flex items-center justify-between rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <div>
                      <p class="font-semibold text-slate-800">Gabriela Melo</p>
                      <p class="text-xs text-slate-500">Puntos: 138 · Racha: 9 días</p>
                    </div>
                    <span class="rounded-full bg-blue-100 px-2 py-0.5 text-xs font-semibold text-blue-700">Bueno</span>
                  </li>
                </ul>
              </section>
              <section>
                <h3 class="text-sm font-semibold text-slate-900">Insights inmediatos</h3>
                <div class="mt-3 space-y-2 text-xs text-slate-500">
                  <p>• Incrementar revisiones sorpresa en galpones con bajo cumplimiento.</p>
                  <p>• Conectar reactivaciones con nuevas capacitaciones específicas.</p>
                  <p>• Activar campaña de reconocimiento a mejores puntajes mensuales.</p>
                </div>
              </section>
            </aside>
          </section>
        </article>

        <article id="tm-operario" data-tm-panel="operario" class="hidden space-y-9">
          <header class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
            <div>
              <h2 class="text-lg font-semibold text-slate-900">Vista operario</h2>
              <p class="text-sm text-slate-500">Experiencia directa para que cada colaborador gestione sus tareas, descansos y sugerencias.</p>
            </div>
            <div class="flex flex-wrap items-center gap-2 text-xs font-semibold text-slate-500">
              <button type="button" class="rounded-full border border-slate-200 px-3 py-1 hover:border-brand hover:text-brand">Ver modo móvil</button>
              <button type="button" class="rounded-full border border-slate-200 px-3 py-1 hover:border-brand hover:text-brand">Enviar recordatorio push</button>
            </div>
          </header>

          <section class="grid gap-6 xl:grid-cols-[minmax(0,1.2fr),minmax(0,1fr)]">
            <div class="space-y-5 rounded-xl border border-slate-200 bg-white p-6 shadow-sm">
              <header class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
                <div>
                  <h3 class="text-base font-semibold text-slate-900">Tareas del día · 04 Nov 2025</h3>
                  <p class="text-sm text-slate-500">Resalta tareas recurrentes, únicas por vencer y aquellas vencidas.</p>
                </div>
                <div class="flex items-center gap-2 text-xs text-slate-500">
                  <label class="flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1">
                    Vista
                    <select class="rounded border border-slate-200 bg-transparent px-2 py-1 text-xs focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/20">
                      <option>Prioridad</option>
                      <option>Horario</option>
                      <option>Estado</option>
                    </select>
                  </label>
                  <button type="button" class="rounded-full border border-slate-200 px-3 py-1 font-semibold hover:border-brand hover:text-brand">Histórico</button>
                  <button type="button" class="rounded-full bg-brand px-3 py-1 text-sm font-semibold text-white hover:bg-brand-dark">Reportar nueva tarea</button>
                </div>
              </header>

              <div class="space-y-4">
                <article class="tm-operario-card border-l-4 border-brand">
                  <header>
                    <h4>Checklist apertura galpón</h4>
                    <span class="tm-badge tm-badge-brand">Recurrente</span>
                    <span class="tm-badge tm-badge-neutral">Prioridad media</span>
                  </header>
                  <p>Completar antes de iniciar el turno. Verifica ventilación, bebederos y bioseguridad.</p>
                  <div class="tm-operario-meta">
                    <span>Turno: Diurno · Posición auxiliar operativo</span>
                    <span>Asignada por: Supervisor bioseguridad</span>
                  </div>
                  <div class="tm-operario-actions">
                    <button type="button">Marcar completada</button>
                    <button type="button">Agregar evidencia</button>
                    <button type="button">Postergar</button>
                  </div>
                </article>

                <article class="tm-operario-card border-l-4 border-rose-400 bg-rose-50/40">
                  <header>
                    <h4>Reporte correctivo galpón 2</h4>
                    <span class="tm-badge tm-badge-critical">Única · Vencida</span>
                  </header>
                  <p>Registrar hallazgos del recorrido nocturno. Adjuntar fotografías.</p>
                  <div class="tm-operario-meta">
                    <span>Turno: Nocturno · Posición líder de turno</span>
                    <span>Asignada para: 03 Nov · Vence hoy</span>
                  </div>
                  <div class="tm-operario-actions">
                    <button type="button">Enviar evidencia</button>
                    <button type="button">Agregar nota</button>
                    <button type="button">Solicitar ayuda</button>
                  </div>
                </article>

                <article class="tm-operario-card border-l-4 border-emerald-400 bg-emerald-50/40">
                  <header>
                    <h4>Capacitación protocolos</h4>
                    <span class="tm-badge tm-badge-success">Extra voluntaria</span>
                  </header>
                  <p>Participa en la sesión de actualización de protocolos de higiene. Suma puntos adicionales.</p>
                  <div class="tm-operario-meta">
                    <span>Horario: 16:00 · Sala formación</span>
                    <span>Reportada por: Gabriela Melo</span>
                  </div>
                  <div class="tm-operario-actions">
                    <button type="button">Acepto realizarla</button>
                    <button type="button">Dejar en pull</button>
                  </div>
                </article>

                <article class="tm-operario-card border-l-4 border-slate-400 bg-slate-50">
                  <header>
                    <h4>Descanso programado</h4>
                    <span class="tm-badge tm-badge-neutral">Automático</span>
                  </header>
                  <p>Descanso compensatorio después de 6 días de racha. No se asignan tareas en esta franja.</p>
                  <div class="tm-operario-meta">
                    <span>Fecha: 05 Nov · Pr&oacute;ximo turno nocturno</span>
                    <span>Generado automáticamente para balancear jornada</span>
                  </div>
                  <div class="tm-operario-actions">
                    <button type="button">Ver historial</button>
                    <button type="button">Solicitar cambio</button>
                  </div>
                </article>
              </div>
            </div>

            <aside class="space-y-5 rounded-xl border border-slate-100 bg-slate-50/40 p-6">
              <section>
                <h3 class="text-sm font-semibold text-slate-900">Mi turno actual</h3>
                <div class="mt-3 rounded-lg border border-slate-200 bg-white p-4 text-sm text-slate-600">
                  <p class="font-semibold text-slate-800">Turno nocturno · Galpón 3</p>
                  <p class="mt-1 text-xs text-slate-500">Posición: Auxiliar operativo</p>
                  <p class="mt-3 text-xs text-slate-500">Próximo turno: 05 Nov · 22:00</p>
                </div>
              </section>
              <section>
                <h3 class="text-sm font-semibold text-slate-900">Puntaje y consistencia</h3>
                <div class="mt-3 space-y-2 rounded-lg border border-slate-200 bg-white p-4 text-xs text-slate-500">
                  <p>Total puntos: <span class="font-semibold text-slate-800">122</span></p>
                  <p>Racha vigente: <span class="font-semibold text-slate-800">6 días cumplidos</span></p>
                  <p>Tareas extra reportadas: <span class="font-semibold text-slate-800">3</span></p>
                  <p class="mt-3 text-slate-500">Sigue reportando iniciativas. Cada aporte aprobado suma 15 puntos.</p>
                </div>
              </section>
              <section>
                <h3 class="text-sm font-semibold text-slate-900">Sugerencias enviadas</h3>
                <ul class="mt-3 space-y-3 text-xs text-slate-500">
                  <li class="rounded-lg border border-emerald-200 bg-white px-3 py-2">
                    Mantenimiento preventivo ventiladores — pendiente revisión del staff.
                  </li>
                  <li class="rounded-lg border border-slate-200 bg-white px-3 py-2">
                    Mejora en checklist de bioseguridad — aprobado y publicado.
                  </li>
                </ul>
              </section>
              <section>
                <h3 class="text-sm font-semibold text-slate-900">Histórico rápido</h3>
                <div class="mt-3 space-y-2 text-xs text-slate-500">
                  <div class="rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <span class="font-semibold text-slate-700">03 Nov</span> · 3 tareas completadas · 1 postergada
                  </div>
                  <div class="rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <span class="font-semibold text-slate-700">02 Nov</span> · 4 tareas completadas
                  </div>
                  <div class="rounded-lg border border-slate-200 bg-white px-3 py-2">
                    <span class="font-semibold text-slate-700">01 Nov</span> · Descanso programado
                  </div>
                </div>
              </section>
            </aside>
          </section>
        </article>
      </div>
    </section>
  </div>

  <style>
    [data-tm-tabs] .tab-button[aria-selected="true"] {
      background-color: rgb(15 23 42);
      color: #fff;
    }
    .alignment-cell {
      min-width: 180px;
      padding: 0.75rem 1rem;
      vertical-align: top;
    }
    .alignment-cell.tm-blank {
      background-color: rgba(248, 250, 252, 0.75);
    }
    .tm-assignment-card {
      border-radius: 0.75rem;
      border: 1px solid rgba(148, 163, 184, 0.35);
      padding: 0.75rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      position: relative;
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4);
    }
    .tm-assignment-card .tm-assignment-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      font-size: 0.75rem;
    }
    .tm-assignment-card .tm-assignment-actions button {
      border-radius: 9999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      padding: 0.25rem 0.75rem;
      font-weight: 600;
      color: rgb(71 85 105);
    }
    .tm-assignment-card .tm-assignment-actions button:hover {
      border-color: rgba(245, 158, 11, 0.9);
      color: rgb(245 158 11);
    }
    .tm-suggestion {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      border-radius: 0.75rem;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background-color: rgba(255, 255, 255, 0.9);
      padding: 1rem;
    }
    .tm-suggestion-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      font-size: 0.75rem;
      font-weight: 600;
    }
    .tm-suggestion-actions button {
      border-radius: 9999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      padding: 0.25rem 0.75rem;
      color: rgb(71 85 105);
    }
    .tm-suggestion-actions button:hover {
      border-color: rgba(245, 158, 11, 0.9);
      color: rgb(245 158 11);
    }
    .tm-operario-card {
      border-radius: 1rem;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background-color: rgba(255, 255, 255, 0.95);
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4);
    }
    .tm-operario-card header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.5rem;
    }
    .tm-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      border-radius: 9999px;
      padding: 0.1rem 0.65rem;
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    .tm-badge-brand {
      background-color: rgba(245, 158, 11, 0.12);
      color: rgb(217, 119, 6);
    }
    .tm-badge-neutral {
      background-color: rgba(148, 163, 184, 0.15);
      color: rgb(71, 85, 105);
    }
    .tm-badge-critical {
      background-color: rgba(248, 113, 113, 0.2);
      color: rgb(185, 28, 28);
    }
    .tm-badge-success {
      background-color: rgba(134, 239, 172, 0.2);
      color: rgb(22, 101, 52);
    }
    .tm-operario-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      font-size: 0.75rem;
      color: rgb(100, 116, 139);
    }
    .tm-operario-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      font-size: 0.75rem;
      font-weight: 600;
    }
    .tm-operario-actions button {
      border-radius: 9999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      padding: 0.25rem 0.75rem;
      color: rgb(71, 85, 105);
    }
    .tm-operario-actions button:hover {
      border-color: rgba(245, 158, 11, 0.9);
      color: rgb(245 158 11);
    }
  </style>

  <script>
    (function () {
      var tabContainer = document.querySelector('[data-tm-tabs]');
      if (!tabContainer) {
        return;
      }
      var buttons = Array.prototype.slice.call(tabContainer.querySelectorAll('.tab-button'));
      var panels = Array.prototype.slice.call(tabContainer.querySelectorAll('[data-tm-panel]'));
      function activate(tabId) {
        panels.forEach(function (panel) {
          var isActive = panel.getAttribute('data-tm-panel') === tabId;
          panel.classList.toggle('hidden', !isActive);
        });
        buttons.forEach(function (button) {
          var isActive = button.getAttribute('data-tm-tab') === tabId;
          button.setAttribute('aria-selected', isActive ? 'true' : 'false');
          button.classList.toggle('bg-slate-900', isActive);
          button.classList.toggle('text-white', isActive);
        });
        var target = tabContainer.querySelector('[data-tm-panel="' + tabId + '"]');
        if (target) {
          target.setAttribute('tabindex', '-1');
          target.focus();
          target.removeAttribute('tabindex');
        }
      }
      buttons.forEach(function (button) {
        button.addEventListener('click', function () {
          activate(button.getAttribute('data-tm-tab'));
        });
      });
      var hash = window.location.hash;
      if (hash && hash.indexOf('tm-') === 1) {
        var tabId = hash.replace('#tm-', '');
        var targetButton = buttons.find(function (button) {
          return button.getAttribute('data-tm-tab') === tabId;
        });
        if (targetButton) {
          activate(tabId);
          return;
        }
      }
      activate('panel');
    })();
  </script>
{% endblock %}
